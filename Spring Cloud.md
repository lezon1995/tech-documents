# Spring Cloud

## 什么是Spring Cloud

Spring Cloud是基于Spring Boot的一套完整的微服务治理框架

## Spring Cloud有什么优势

使用Spring Boot开发分布式微服务时，我们面临以下问题

- 与分布式系统相关的复杂性

  > 这种开销包括网络问题，延迟开销，带宽问题，安全问题

- 服务发现

  > 服务发现工具管理群集中的流程和服务如何查找和互相交谈
  >
  > 它涉及一个服务目录，在该目录中注册服务，然后能够查找并连接到该目录中的服务

- 冗余

  > 分布式系统中的冗余问题

- 负载平衡

  > 负载平衡改善跨多个计算资源的工作负荷

- 性能

  > 由于各种运营开销导致的性能问题

- 部署复杂性

  > Devops技能的要求

## 服务注册和发现是什么意思？

当我们开始一个项目时，我们通常在属性文件中进行所有的配置

随着越来越多的服务开发和部署，添加和修改这些属性变得更加复杂

有些服务可能会下降，而某些位置可能会发生变化，手动更改属性可能会产生问题

 `Eureka`服务`注册`和`发现`可以在这种情况下提供帮助

由于所有`服务`都在`Eureka服务器`上注册并通过调用Eureka服务器完成查找，因此无需处理服务地点的任何更改和处理

## 负载均衡的意义

在给大量用户提供服务的时候，一台机器可能支持不了那么多请求

所以这个时候会选用多台机器来提供服务

假如某台机器配置相对较低，但分配到的请求数却和配置较高的机器是一样的

这样就可能导致配置较低的机器还是承载不了那么多请求量，从而挂掉

`负载均衡`不是指每台机器平均分配请求量。因为不同的机器配置不同，所以需要酌情分配，让每个机器都能在不被请求量打死的情况下，发挥自己最大的能力

负载均衡常用的策略有

- 轮询（round robin）
- 随机（random）
- 权重（weight）
- 最少活跃（least active）

## 什么是Hystrix？

`Hystrix`是一个`延迟`和`容错`的组件，旨在`隔离远程系统`，`服务`和`第三方库`的访问点

当多个微服务之间的某一服务出现故障，能够有效隔断故障的传递，保护服务自身的资源不被耗尽，并且在故障节点做降级处理，使多个服务仍然处于运行状态

## 什么是Feign？

Feign是Neflix公司开发的一款微服务之间的REST风格调用框架

## 什么是Spring Cloud Bus？

在Spring Cloud中我们使用配置文件来读取配置的方式已经不再推荐

而是使用`Spring Cloud Config`来实现配置文件读取

通过将原生配置文件上传到`Git`或者`文件服务器`，然后通过连接到`Eureka Server`，通过`Eureka Server`去Git服务器上拉取配置信息，再将配置信息传到相应的`Eureka Client`上

但是如果需要修改配置文件的话，那么就需要重新启动服务，再去拉取最新的配置文件

`Spring Cloud Bus`可以实现实时刷新配置文件的功能

当配置文件被修改并且被push到git上，`Spring Cloud Bus`会向`Eureka Server`发送消息，让其通知相应的`Eureka Client`去拉取最新的配置信息，并且动态的修改内存中的配置（除了端口等一些配置不能刷新）